---
title: "02-email"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r loading data, message=FALSE, warning=FALSE, include=FALSE}
rm(list = ls())

# load packages 
for (pkg in c("tidyverse", "igraph", "visNetwork", "data.table", "R.utils", "RPostgreSQL", "cowplot", "maditr", "stringr", "stringi", "mosaic", "sf", "raster", "dplyr", "spData", "spDataLarge", "tmap", "leaflet", "mapview", "ggplot2", "shiny", "maps", "plotly")) {
  library(pkg, character.only = TRUE)
}


# connect to postgresql to get our data
conn <- dbConnect(drv = PostgreSQL(), 
                  dbname = "sdad", 
                  host = "10.250.124.195", 
                  port = 5432, 
                  user = Sys.getenv("db_userid"), 
                  password = Sys.getenv("db_pwd"))

gh_extra <- dbGetQuery(conn, "SELECT *
                              FROM gh.ctrs_extra")

# disconnect from postgresql database 
dbDisconnect(conn)
```


```{r}
email_clean <- gh_extra%>%
  filter(!is.na(email))

#domain
email_domain_top15 <- email_clean %>%
  mutate(email_domain =  str_extract(email_clean$email, "@[a-z]+"))%>%
  group_by(email_domain)%>%
  summarize(N = n())%>%
  arrange(desc(N))%>%
  top_n(15, N)

email_domain_top15


#edu email
table(grepl("edu", email_clean$email))
```

